<?php
/*
Template Name: Graphisme
*/
?>


<body> 
<div class="pattern-background">

<?php 
get_header(); 
?>

<main class="page-graphisme">
  <div class="border gauche"></div>
  <div class="border droite"></div>

  <!-- ===================== Présentation Graphisme ===================== -->
  <section class="presentation-graphisme">
    <h1 class="titre-graphisme" aria-label="graphisme">
      <span class="titre-graphisme-layer titre-graphisme--base">GRAPHISME</span>
      <span class="titre-graphisme-layer titre-graphisme-layer--1">GRAPHISME</span>
      <span class="titre-graphisme-layer titre-graphisme-layer--2">GRAPHISME</span>
      <span class="titre-graphisme-layer titre-graphisme-layer--3">GRAPHISME</span>
    </h1>

    <svg class="logo-graphisme" width="100" height="122" viewBox="0 0 100 122" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M97.0801 0.508789C102.803 39.1876 98.5018 112.756 35.5107 97.6006C41.8261 81.6158 63.3355 46.6873 77.5439 37.2148C82.2801 34.0574 72.8083 25.9666 68.6641 30.1104C55.8366 39.9774 25.6828 73.3285 12.4219 118.322C10.8512 123.65 -1.19508 119.506 1.17285 114.178L13.6055 85.1689C-6.72066 57.9359 -18.4827 2.87695 97.0801 0.508789Z" fill="#00978F" style="mix-blend-mode:difference"/>
    <path d="M97.0801 0.508789L97.5747 0.435604L97.5102 -0.000130585L97.0698 0.00889401L97.0801 0.508789ZM35.5107 97.6006L35.0457 97.4169L34.8343 97.9521L35.3938 98.0867L35.5107 97.6006ZM77.5439 37.2148L77.2666 36.7988L77.2666 36.7988L77.5439 37.2148ZM68.6641 30.1104L68.9689 30.5067L68.9946 30.4869L69.0176 30.4639L68.6641 30.1104ZM12.4219 118.322L12.9015 118.464L12.9015 118.464L12.4219 118.322ZM1.17285 114.178L1.6298 114.381L1.63242 114.375L1.17285 114.178ZM13.6055 85.1689L14.065 85.3659L14.1786 85.1009L14.0062 84.8699L13.6055 85.1689ZM97.0801 0.508789L96.5855 0.581974C99.4414 19.8837 99.7858 47.846 91.5967 69.0625C87.5054 79.6625 81.3007 88.5367 72.2575 93.8315C63.2225 99.1214 51.2818 100.881 35.6277 97.1145L35.5107 97.6006L35.3938 98.0867C51.2352 101.898 63.4538 100.145 72.7627 94.6944C82.0634 89.2489 88.3872 80.1551 92.5297 69.4226C100.808 47.9741 100.442 19.8127 97.5747 0.435604L97.0801 0.508789ZM35.5107 97.6006L35.9758 97.7843C39.1156 89.8369 46.0513 77.1412 53.9835 65.2429C57.9475 59.2968 62.1541 53.5595 66.2517 48.7216C70.3545 43.8775 74.3273 39.9603 77.8213 37.6309L77.5439 37.2148L77.2666 36.7988C73.6564 39.2056 69.6123 43.2066 65.4886 48.0753C61.3597 52.9501 57.1302 58.72 53.1514 64.6882C45.1979 76.6185 38.2212 89.3794 35.0457 97.4169L35.5107 97.6006ZM77.5439 37.2148L77.8213 37.6309C78.4893 37.1855 78.9349 36.6326 79.1624 36.003C79.3888 35.3762 79.3848 34.7133 79.2221 34.0678C78.9005 32.7916 77.9484 31.5293 76.753 30.5396C75.552 29.5451 74.0473 28.7767 72.5455 28.5347C71.0345 28.2911 69.4885 28.579 68.3105 29.7568L68.6641 30.1104L69.0176 30.4639C69.9118 29.5699 71.1038 29.3152 72.3864 29.5219C73.6781 29.7301 75.0223 30.4048 76.1153 31.3098C77.2139 32.2195 78.0006 33.3129 78.2525 34.3122C78.3765 34.8045 78.3678 35.2593 78.2219 35.6632C78.077 36.0642 77.7826 36.4548 77.2666 36.7988L77.5439 37.2148ZM68.6641 30.1104L68.3592 29.714C55.4577 39.638 25.2364 73.0747 11.9423 118.181L12.4219 118.322L12.9015 118.464C26.1293 73.5823 56.2154 40.3168 68.9689 30.5067L68.6641 30.1104ZM12.4219 118.322L11.9423 118.181C11.6148 119.292 10.7495 119.932 9.56525 120.182C8.36505 120.436 6.88192 120.271 5.48801 119.775C4.09347 119.279 2.85156 118.474 2.10522 117.515C1.37308 116.575 1.12763 115.511 1.62976 114.381L1.17285 114.178L0.715942 113.975C0.0341097 115.509 0.406472 116.961 1.31612 118.129C2.21155 119.28 3.6354 120.177 5.15278 120.717C6.67078 121.257 8.34573 121.462 9.77196 121.161C11.2141 120.856 12.4436 120.017 12.9015 118.464L12.4219 118.322ZM1.17285 114.178L1.63242 114.375L14.065 85.3659L13.6055 85.1689L13.1459 84.972L0.713281 113.981L1.17285 114.178ZM13.6055 85.1689L14.0062 84.8699C3.87808 71.3002 -4.00026 50.9456 4.82928 33.7428C13.6559 16.5458 39.334 2.19225 97.0903 1.00868L97.0801 0.508789L97.0698 0.00889401C39.2634 1.19349 13.0412 15.5534 3.93962 33.2862C-5.159 51.0132 3.00673 71.8046 13.2048 85.468L13.6055 85.1689Z" fill="#E3E3E3" style="mix-blend-mode:difference"/>
    </svg>

    <div class="conteneur-description-graphisme">
      <p class="description-titre">Description</p>
      <p class="description-texte">
        Dans le cours <strong><em>Conception graphique et imagerie vectorielle</em></strong>,
        les étudiants de première année ont réalisé une recherche sur un enjeu environnemental.
        À partir de cette recherche, ils ont imaginé un jeu vidéo ou une application permettant
        de sensibiliser la population à cet enjeu. Ils en ont conçu l’identité visuelle et l’ont
        présentée sous forme d’affiche. Le code QR présent sur chaque affiche donne accès à une
        présentation détaillant le projet proposé.
      </p>
    </div>
  </section>

  <!-- ===================== Barre de filtre ===================== -->
  <div class="filter-bar">
    <select id="filter-select" name="filter-select" aria-label="Filtrer projets types d'option">
      <option value="all">Tous</option>
      <option value="A">Option 1</option>
      <option value="B">Option 2</option>
      <option value="C">Option 3</option>
      <option value="D">Option 4</option>
    </select>
  </div>

  <!-- ===================== Liste des projets ===================== -->
  <section class="liste-projet-graphisme">
    <?php
    $projets = new WP_Query([
      'post_type'      => 'projet-graphisme',
      'posts_per_page' => -1,
      'orderby'        => 'title',
      'order'          => 'ASC'
    ]);

    if ($projets->have_posts()) :
      while ($projets->have_posts()) :
        $projets->the_post();

        $titre       = get_the_title();
        $image       = get_field('affiche');
        $description = get_field('description');
        $etudiants   = get_field('etudiants_associes');
        $behance     = get_field('liens_behance');
      $short_desc = wp_trim_words( wp_strip_all_tags( $description ), 40, '...' );
    ?>

    <!-- ===== Carte Projet Desktop ===== -->
    <article class="carte-projet-graphisme carte-projet-graphisme--desktop">
      <?php if (!empty($image) && !empty($image['url'])) : ?>
          <img class="image-projet-graphisme"
               src="<?php echo esc_url($image['url']); ?>"
               alt="<?php echo esc_attr($image['alt'] ?: $titre); ?>">
      <?php endif; ?>

      <div class="conteneur-carte-bas">
        <h2 class="titre-projet-graphisme"><?php echo esc_html($titre); ?></h2>
        <p class="carte-graphisme-titre-description">Description</p>
        <p class="description-projet"><?php echo esc_html($short_desc); ?></p>

        <?php /*
          <?php if (!empty($etudiants)) : ?>
            <p class="etudiants-projet">
              <strong>Étudiants :</strong>
              <?php
              $liste = array_map(function ($etudiant) {
                return get_the_title($etudiant->ID);
              }, $etudiants);
              echo esc_html(implode(', ', $liste));
              ?>
            </p>
          <?php endif; ?>

          <?php if ($behance) : ?>
            <p class="behance-projet">
              <a href="<?php echo esc_url($behance); ?>" target="_blank" rel="noopener noreferrer">
                Voir sur Behance
              </a>
            </p>
          <?php endif; ?>
        */ ?>

        <button class="button-projet-graphisme"
          onclick="window.location.href='<?php echo esc_url(add_query_arg('projet_id', get_the_ID(), get_permalink(get_page_by_path('projet-arcade')))); ?>'">
          >>
        </button>
      </div>
    </article>


    
    <!-- ===== Carte Projet Mobile ===== -->
   <article class="carte-projet-graphisme carte-projet-graphisme--mobile">
      <div class="bloc-titre">
        <h2 class="titre-projet-graphisme"><?php echo esc_html($titre); ?></h2>
        <button class="button-projet-graphisme"
            onclick="window.location.href='<?php echo esc_url(add_query_arg('projet_id', get_the_ID(), get_permalink(get_page_by_path('projet-arcade')))); ?>'">
            &gt;&gt;
          </button>
      </div>

      <?php if ($image): ?>
        <img class="image-projet-graphisme" src="<?php echo esc_url($image['url']); ?>" alt="<?php echo esc_attr($titre); ?>">
        
        <span class="conteneur-button-dropdown-graphisme">
          <p class="carte-graphisme-titre-description">Description</p>
          <button
            class="button-dropdown-graphisme"
            aria-expanded="false"
            aria-controls="<?php echo 'dropdown-'.get_the_ID(); ?>">
            +
          </button>
        </span>

        <div id="<?php echo 'dropdown-'.get_the_ID(); ?>" class="dropdown-carte-graphisme" aria-hidden="true">
          <p class="description-projet"><?php echo esc_html($short_desc); ?></p>
        </div>
        
      <?php /* ?>
        <?php if (!empty($image) && !empty($image['url'])) : ?>
            <img class="image-projet-graphisme"
                src="<?php echo esc_url($image['url']); ?>"
                alt="<?php echo esc_attr($image['alt'] ?: $titre); ?>">
        <?php endif; ?>

        <div class="conteneur-carte-bas">
          <h2 class="titre-projet-graphisme"><?php echo esc_html($titre); ?></h2>

          <?php if ($description) : ?>
          <p class="carte-graphisme-titre-description">Description</p>
          <p class="description-projet"><?php echo esc_html($description); ?></p>
          <?php endif; ?>

          <?php if (!empty($etudiants)) : ?>
            <p class="etudiants-projet">
          <strong>Étudiants :</strong>
          <?php
          $liste = array_map(function ($etudiant) {
            return get_the_title($etudiant->ID);
          }, $etudiants);
          echo esc_html(implode(', ', $liste));
          ?>
            </p>
          <?php endif; ?>

          <?php if ($behance) : ?>
            <p class="behance-projet">
          <a href="<?php echo esc_url($behance); ?>" target="_blank" rel="noopener noreferrer">
            Voir sur Behance
          </a>
            </p>
          <?php endif; ?>
        </div>
      <?php */ ?>

    </article>
    <?php endif; ?>

    <?php
      endwhile;
      wp_reset_postdata();
    else :
      echo '<p class="message-aucun-projet">Aucun projet trouvé pour le moment.</p>';
    endif;
    ?>
  </section>
</main>

  <?php get_footer(); ?>
</div>
</body>
